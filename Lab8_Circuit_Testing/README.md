# Lab8_Circuit_Testing

使用 AD9851 实现不同频率正弦波的发生，经过衰减电路后输入到待测放大电路输入端。通过采样电路获取输入端电压、输入端电流、输出端电压，其中电流信号使用 AD620 配合采样电阻进行差分放大，电压信号使用高速运放两级放大。将放大后的电压、电流信号接至单片机 AD 口进行采样，通过采样电路的输入输出倍率关系获取电压电流的实测值，并计算该放大电路的电路特性。同时，结合不同故障带来的电路特性变化，分析该放大电路出现的故障类型。

## 分工

|            | 模块               | 要求                                                         | 人员 |
| ---------- | ------------------ | ------------------------------------------------------------ | ---- |
| 系统输出端 | AD9851正弦波的发生 | 频率范围：300kHz以上                                         |      |
|            | 幅值衰减           | 结合DDS输出值，衰减至                                        |      |
|            | 电流信号采集       | 放大至单片机要求，并给出稳定倍率关系                         |      |
|            | 电压信号采集       | 放大至单片机要求，并给出稳定倍率关系                         |      |
| 系统输入端 | 电流信号采集       | 放大至单片机要求，并给出稳定倍率关系                         |      |
|            | 电压信号采集       | 放大至单片机要求，并给出稳定倍率关系                         |      |
|            | 单片机采样         | 获得实测电压电流值                                           |      |
| 软件分析   | 输入电阻测量       | 1kohm~50kohm                                                 |      |
|            | 输出电阻测量       | 500ohm~50kohm                                                |      |
|            | 增益               | 1kHz，误差小于10%                                            |      |
|            | 频幅特性曲线       | 显示上限频率值，误差小于25%                                  |      |
|            | 任意电阻开路或短路 | 判断并显示原因                                               |      |
|            | 任意开路电容       | 判断并显示原因                                               |      |
|            | 增大任意电容至2倍  | 判断并显示原因                                               |      |
|            | （判断速度<=2s）   |                                                              |      |
| 被测电路   | 9013放大电路       | 一对输入输出，所有元件实现可替换。并仿真分析电路特性，给出合适的输入和输出范围。 |      |

## 电路分析

方案一：82k、82k分压，Rs=2.4k

| 故障内容 | 故障分析                               | 输入电压值峰峰值 | 输入电流对应差分电压值 | 输出电压峰峰值（无负载） | 输出电压峰峰值（有负载） |
| -------- | -------------------------------------- | ---------------- | ---------------------- | ------------------------ | ------------------------ |
| 正常情况 |                                        | 23.2mV           | 26.5mV                 | 3.5Vpp，7.35VDC          | 2.08Vpp, 4.42VDC         |
| R1开路   | 输入电阻变大                           | **128mV**        | 20mV                   | **12V（DC）**            | 7.2V（直流）             |
| R1短路   | 输出电压接近11V                        | 182μV            | 26.5mV                 | **10.6V（直流）**        | 10.4V（DC）              |
| R2开路   | 输出电压4V                             | 1.4mV            | 26mV                   | **4.14V（DC）**          | 3.39V（DC）              |
| R2短路   | 输出电压为12V，输出电阻2k，输入电阻为0 | **接近0**        | 26mV                   | **12V（DC）**            | **7.2V（DC）**           |
| R3开路   | 输出电压为200mV                        | 2.18mVpp         | 25mVpp                 | 200mV(**接近0**)         | 150mV(接近0)             |
| R3短路   | 输出电压12V                            | 24.6mVpp         | 26mV                   | **12VDC**                | 12VDC                    |
| R4开路   | 输入阻抗比R1开路稍小                   | **102mVpp**      | 20mVpp                 | 12V                      | 7.2V                     |
| R4短路   | 输出电压很小几十mV，输入阻抗极小       | **1.19mVpp**     | 26mVpp                 | 40.2mVDC                 | 40.2mVDC                 |
| C1开路   | 输入阻抗无穷大                         | **500mVpp**      | **0**                  | **7.35VDC**              | 4.42VDC                  |
| C1加倍   | **20Hz**，FFT计算电流电压相位差        | 5                | 26mVpp                 | 3.5Vpp, 7.35VDC          | 2.08Vpp, 4.42VDC         |
| C2开路   | 输入电阻变大，增益降低                 | 97.5mVpp         | 20mVpp                 | 192mVpp，7.35VDC         | 115mVpp，4.42VDC         |
| C2加倍   | 低频增益变大                           | 22.7mVpp         | 26mVpp                 | 3.51Vpp, 7.35VDC         | 2.08Vpp,4.42VDC          |
| C3开路   | 高频增益变高                           | 23.3mVpp         | 26mVpp                 | 3.5Vpp, 7.35VDC          | 2.08Vpp, 4.42VDC         |
| C3加倍   | 高频增益变低                           | 23.2mVpp         | 26mVpp                 | 3.5Vpp, 7.35VDC          | 2.08Vpp, 4.42VDC         |
|          |                                        |                  |                        |                          |                          |



方案二：分压电阻100k，4.7k。后接入跟随器，电流采样电阻2.2k

| 故障内容   | 故障分析                               | 输入电压值峰峰值 | 输入电流对应差分电压值 | 输出电压峰峰值（无负载） | 输出电压峰峰值（有负载） |
| ---------- | -------------------------------------- | ---------------- | ---------------------- | ------------------------ | ------------------------ |
| 正常情况   |                                        | 22.0mVpp         | 24mVpp                 | 3.35Vpp，7.34VDC         | 2.02Vpp, 4.41VDC         |
| **R1开路** | 输入电阻变大                           | 39.1mVpp         | 5.6mVpp                | **12V（DC）**            | 7.2V（直流）             |
| R1短路     | 输出电压接近11V                        |                  |                        |                          |                          |
| R2开路     | 输出电压4V                             | 1.4mV            | 26mV                   | **4.14V（DC）**          | 3.39V（DC）              |
| R2短路     | 输出电压为12V，输出电阻2k，输入电阻为0 | **接近0**        | 26mV                   | **12V（DC）**            | **7.2V（DC）**           |
| R3开路     | 输出电压为200mV                        | 2.18mVpp         | 25mVpp                 | 200mV(**接近0**)         | 150mV(接近0)             |
| R3短路     | 输出电压12V                            | 24.6mVpp         | 26mV                   | **12VDC**                | 12VDC                    |
| **R4开路** | 输入阻抗比R1开路稍小                   | 37.4mVpp         | 7.2mV                  | 12V                      | 7.2V                     |
| R4短路     | 输出电压很小几十mV，输入阻抗极小       | **1.19mVpp**     | 26mVpp                 | 40.2mVDC                 | 40.2mVDC                 |
| C1开路     | 输入阻抗无穷大                         | 44.9mV           | **0**                  | **7.35VDC**              | 4.42VDC                  |
| C1加倍     | **20Hz**，FFT计算电流电压相位差        | 5                | 26mVpp                 | 3.5Vpp, 7.35VDC          | 2.08Vpp, 4.42VDC         |
| C2开路     | 输入电阻变大，增益降低                 | 97.5mVpp         | 20mVpp                 | 192mVpp，7.35VDC         | 115mVpp，4.42VDC         |
| C2加倍     | 低频增益变大                           | 22.7mVpp         | 26mVpp                 | 3.51Vpp, 7.35VDC         | 2.08Vpp,4.42VDC          |
| C3开路     | 高频增益变高                           | 23.3mVpp         | 26mVpp                 | 3.5Vpp, 7.35VDC          | 2.08Vpp, 4.42VDC         |
| C3加倍     | 高频增益变低                           | 23.2mVpp         | 26mVpp                 | 3.5Vpp, 7.35VDC          | 2.08Vpp, 4.42VDC         |
|            |                                        |                  |                        |                          |                          |



## 初步方案设计

### 放大电路输入端电流采样：

INA128仪表放大器，

### 放大电路输入端电压采样：

INA333仪表放大器，

### 放大电路输出端电压采样：

op27
